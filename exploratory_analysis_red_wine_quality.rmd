---
title: "Exploratory Data Analysis on Red Wine Quality"
output: pdf_document
---

```{r setup, echo=FALSE,include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE,message=FALSE, results='hide', warning=FALSE}
#Initial imports
library(ggplot2)
library(dplyr)
library(GGally)
library(gridExtra)
```

# Getting to Know the Database

Viewing the first 6 rows in the dataset to see how the data looks like.

```{r, echo=FALSE,message=FALSE, warning=FALSE}
redwine <- read.csv('../Project/wineQualityReds.csv', sep = ',')
head(redwine)
```

There are 11 chemicals in the table that can influence the quality of red wine. For instance acidity level, sugar, PH level, alcohol, etc. The last column in the table specifies the quality (score between 0 to 10) of the wine based on all the chemicals.

Now let's get some info on different types of data in the dataset. According to the table below, `row number` and `quality` are of type integer, while the rest of the variables are numeric.

```{r, echo=FALSE,message=FALSE, warning=FALSE}
str(redwine)
```

I would also like to take some numeric summary of the data from each variable in the dataset.

```{r, echo=FALSE,message=FALSE, warning=FALSE}
summary(redwine)
```

From the summary, the average quality of red wines in the database is 5.63, with the maximum ranking set to 8 and the minimum set to 3. Therefor, there is no red wine in the database with a quality of 10 or 0.

# Univariate Plots Section

I will now create some basic histograms for each chemical property in the table. 

First I like to see how the `quality` property is distributed in the table: 

```{r, echo=FALSE,message=FALSE, warning=FALSE}
ggplot(data = redwine,
       aes(x=quality)) +
  geom_histogram(colour = I('#741B3E'), fill = I('#741B3E'), binwidth = 0.5) +
  scale_x_continuous(limits = c(0,10), breaks = seq(0,10,1)) +
  xlab('Quality of Red Wine - Worst(0) to Best(10)') +
  ylab('Number of Red Wines')

ggsave('quality_hist.png', height = 4, width = 5, dpi = 600)
```

Based on the plot the majority of the red wines, about more than 1200, have either 5 or 6 ranking for their quality. About 200 red wines have quality ranking as 7, but the number is not as significant as 5 and 6. The rest are either 3,4 or 8.

After looking at the quality distribution, I'd like to get a histogram of all the chemical properties - as well as quality - in the table. These histograms can also help me in finding out if any of values in the plots need to be changed to e.g. log10 for a smoother distribution.

```{r, echo=FALSE,message=FALSE, warning=FALSE}
get_histogram <- function(var, xlabel) {
  return (qplot(x = var, data = redwine, xlab = xlabel, 
                color= I('#741B3E'), fill = I('#741B3E')))
}

grid.arrange(get_histogram(redwine$fixed.acidity, 'Fixed Acidity'),
get_histogram(redwine$volatile.acidity, 'Volatile Acidity'),
get_histogram(redwine$citric.acid, 'Citric Acid'),
get_histogram(redwine$residual.sugar, 'Residual Sugar'),
get_histogram(redwine$chlorides, 'Chlorides'),
get_histogram(redwine$free.sulfur.dioxide, 'Free Sulfur Dioxide'),
get_histogram(redwine$total.sulfur.dioxide, 'Total Sulfur Dioxide'),
get_histogram(redwine$density, 'Density'),
get_histogram(redwine$pH, 'PH'),
get_histogram(redwine$sulphates, 'Sulphates'),
get_histogram(redwine$alcohol, 'Alcohol'),
get_histogram(redwine$quality, 'Quality'),
ncol = 3)
```

Based on the above plots, I feel that `total.sulfur.dioxide` and `free.sulfur.dioxide` have distributions skewed to left, and I can use `log10` on their x-axis to change those distributions to normal. Let's see how this will look like.

```{r, echo=FALSE,message=FALSE, warning=FALS}
log10 <- ggplot(data = redwine,
                aes(x=log10(total.sulfur.dioxide))) +
  geom_histogram(color = I('#985871'), fill = I('#985871'), binwidth = 0.05) +
  xlab('Log10 of Total Sulfur Dioxide') +
  ylab('Count')

normal <- ggplot(data = redwine,
                 aes(x=total.sulfur.dioxide)) +
  geom_histogram() +
  xlab('Total Sulfur Dioxide') +
  ylab('Count')

grid.arrange(log10, normal, ncol=1)
```

Based on the plots, as you can see, using `log10` on the x-axis for `Total Sulfur Dioxide` helped the distribution to look normal-ish.

Applying `log10` on the x-axis does not work for `Free Sulfur Dioxide`, though. It change the distribution, but seems it is a bit more skewed to the right, rather than normally distributed.

```{r, echo=FALSE,message=FALSE, warning=FALS}
log10_free <- ggplot(data = redwine,
                aes(x=log10(free.sulfur.dioxide))) +
  geom_histogram(color = I('#985871'), fill = I('#985871'), binwidth = 0.05) +
  xlab('Log10 of Free Sulfur Dioxide') +
  ylab('Count')

normal_free <- ggplot(data = redwine,
                 aes(x=free.sulfur.dioxide)) +
  geom_histogram() +
  xlab('Free Sulfur Dioxide') +
  ylab('Count')

grid.arrange(log10_free, normal_free, ncol=1)
```



